@using BlazingQuiz.Web.Services.Theme
@implements IDisposable
@inject ThemeService ThemeService

<div class="theme-toggle-container">
    <div class="radio-group">
        <label class="radio-option @(ThemeService.CurrentTheme == ThemeMode.Light ? "active" : "")">
            <input type="radio"
                   name="theme"
                   value="light"
                   checked="@(ThemeService.CurrentTheme == ThemeMode.Light)"
                   @onchange="() => OnThemeChange(ThemeMode.Light)" />
            <span class="icon">‚òÄÔ∏è</span>
        </label>
        <label class="radio-option @(ThemeService.CurrentTheme == ThemeMode.Dark ? "active" : "")">
            <input type="radio"
                   name="theme"
                   value="dark"
                   checked="@(ThemeService.CurrentTheme == ThemeMode.Dark)"
                   @onchange="() => OnThemeChange(ThemeMode.Dark)" />
            <span class="icon">üåô</span>
        </label>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        await ThemeService.InitializeThemeAsync();
        ThemeService.OnThemeChanged += StateHasChanged;
    }

    private async Task OnThemeChange(ThemeMode theme)
    {
        await ThemeService.SetThemeAsync(theme);
    }

    public void Dispose()
    {
        ThemeService.OnThemeChanged -= StateHasChanged;
    }
}

<style scoped>
    .theme-toggle-container {
        display: flex;
        align-items: center;
    }

    .radio-group {
        display: flex;
        border: 2px solid var(--bs-gray-300);
        border-radius: 50px;
        overflow: hidden;
        background: linear-gradient(145deg, #e6e6e6, #ffffff);
        box-shadow:
            8px 8px 16px #d1d1d1,
            -8px -8px 16px #ffffff;
        position: relative;
    }

    .radio-option {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0.4rem 0.8rem;
        cursor: pointer;
        position: relative;
        transition: all 0.3s ease;
        min-width: 40px;
        height: 40px;
        background-color: transparent;
        font-weight: 500;
        text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
    }

    .radio-option:not(:last-child) {
        border-right: 1px solid rgba(0,0,0,0.1);
    }

    .radio-option:hover {
        background: linear-gradient(145deg, #d9d9d9, #ffffff);
        transform: translateY(-2px);
        box-shadow:
            5px 5px 10px #c4c4c4,
            -5px -5px 10px #ffffff;
    }

    .radio-option.active {
        background: linear-gradient(145deg, var(--bs-primary), var(--bs-primary-dark, #0b5ed7));
        color: white;
        font-weight: bold;
        box-shadow:
            inset 4px 4px 8px rgba(0,0,0,0.2),
            inset -4px -4px 8px rgba(255,255,255,0.1),
            0 4px 8px rgba(0,0,0,0.2);
        transform: translateY(-1px);
        z-index: 1;
    }

    .radio-option.active:hover {
        background: linear-gradient(145deg, var(--bs-primary-dark, #0b5ed7), var(--bs-primary));
        box-shadow:
            inset 4px 4px 8px rgba(0,0,0,0.3),
            inset -4px -4px 8px rgba(255,255,255,0.1),
            0 6px 12px rgba(0,0,0,0.25);
    }

    .radio-option input[type="radio"] {
        opacity: 0;
        position: absolute;
        width: 0;
        height: 0;
    }

    .icon {
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        transition: transform 0.2s ease;
    }

    .radio-option:hover .icon {
        transform: scale(1.1);
    }

    /* Add specific icon colors for better contrast */
    .radio-option.active .icon {
        filter: brightness(0) invert(1); /* Makes icons white when active */
    }
</style>