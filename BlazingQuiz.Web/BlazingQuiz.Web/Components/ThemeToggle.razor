@using BlazingQuiz.Web.Services.Theme
@implements IDisposable
@inject ThemeService ThemeService

<div class="theme-toggle-container">
    <div class="radio-group">
        <label class="radio-option @(ThemeService.CurrentTheme == ThemeMode.Light ? "active" : "")">
            <input type="radio"
                   name="theme"
                   value="light"
                   checked="@(ThemeService.CurrentTheme == ThemeMode.Light)"
                   @onchange="() => OnThemeChange(ThemeMode.Light)" />
            <span class="icon">‚òÄÔ∏è</span>
        </label>
        <label class="radio-option @(ThemeService.CurrentTheme == ThemeMode.Dark ? "active" : "")">
            <input type="radio"
                   name="theme"
                   value="dark"
                   checked="@(ThemeService.CurrentTheme == ThemeMode.Dark)"
                   @onchange="() => OnThemeChange(ThemeMode.Dark)" />
            <span class="icon">üåô</span>
        </label>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        await ThemeService.InitializeThemeAsync();
        ThemeService.OnThemeChanged += StateHasChanged;
    }

    private async Task OnThemeChange(ThemeMode theme)
    {
        await ThemeService.SetThemeAsync(theme);
    }

    public void Dispose()
    {
        ThemeService.OnThemeChanged -= StateHasChanged;
    }
}

<style scoped>
    .theme-toggle-container {
        display: flex;
        align-items: center;
    }

    .radio-group {
        display: flex;
        border: 2px solid var(--bs-gray-300);
        border-radius: 50px;
        overflow: hidden;
        background-color: var(--bs-light);
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .radio-option {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0.4rem 0.8rem;
        cursor: pointer;
        position: relative;
        transition: all 0.2s ease;
        min-width: 40px;
        height: 40px;
        background-color: transparent;
    }

    .radio-option:not(:last-child) {
        border-right: 1px solid var(--bs-gray-300);
    }

    .radio-option:hover {
        background-color: var(--bs-gray-200);
    }

    .radio-option.active {
        background-color: var(--bs-primary);
        color: white;
        font-weight: bold;
    }

    .radio-option.active:hover {
        background-color: var(--bs-primary-dark, #0b5ed7);
    }

    .radio-option input[type="radio"] {
        opacity: 0;
        position: absolute;
        width: 0;
        height: 0;
    }

    .icon {
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
    }

    /* Add specific icon colors for better contrast */
    .radio-option.active .icon {
        filter: brightness(0) invert(1); /* Makes icons white when active */
    }
</style>